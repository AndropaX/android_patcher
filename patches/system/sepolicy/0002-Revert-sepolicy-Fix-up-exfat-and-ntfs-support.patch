From 9d4b20ffd709b84895ac6fbedccfc938fe4ae626 Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Wed, 21 Feb 2018 02:57:29 +0100
Subject: [PATCH 02/11] Revert "sepolicy: Fix up exfat and ntfs support"

This reverts commit 6e0167a0c40ee7d7e1fc9a2c3be8b26b4598ebe2.
---
 private/app.te             | 14 ++++----------
 private/app_neverallows.te |  3 ---
 2 files changed, 4 insertions(+), 13 deletions(-)

diff --git a/private/app.te b/private/app.te
index fe036926..c0deb085 100644
--- a/private/app.te
+++ b/private/app.te
@@ -238,21 +238,15 @@ allow { appdomain -isolated_app -ephemeral_app } sdcardfs:dir create_dir_perms;
 allow { appdomain -isolated_app -ephemeral_app } sdcardfs:file create_file_perms;
 # This should be removed if sdcardfs is modified to alter the secontext for its
 # accesses to the underlying FS.
-allow { appdomain -isolated_app -ephemeral_app } { exfat fuseblk media_rw_data_file ntfs sdcard_posix vfat }:dir create_dir_perms;
-allow { appdomain -isolated_app -ephemeral_app } { exfat fuseblk media_rw_data_file ntfs sdcard_posix vfat }:file create_file_perms;
+allow { appdomain -isolated_app -ephemeral_app } { media_rw_data_file sdcard_posix vfat }:dir create_dir_perms;
+allow { appdomain -isolated_app -ephemeral_app } { media_rw_data_file sdcard_posix vfat }:file create_file_perms;
 
 # Access OBBs (vfat images) mounted by vold (b/17633509)
 # File write access allowed for FDs returned through Storage Access Framework
-allow { appdomain -isolated_app -ephemeral_app } exfat:dir r_dir_perms;
-allow { appdomain -isolated_app -ephemeral_app } exfat:file rw_file_perms;
-allow { appdomain -isolated_app -ephemeral_app } fuseblk:dir r_dir_perms;
-allow { appdomain -isolated_app -ephemeral_app } fuseblk:file rw_file_perms;
-allow { appdomain -isolated_app -ephemeral_app } ntfs:dir r_dir_perms;
-allow { appdomain -isolated_app -ephemeral_app } ntfs:file rw_file_perms;
-allow { appdomain -isolated_app -ephemeral_app } sdcard_posix:dir r_dir_perms;
-allow { appdomain -isolated_app -ephemeral_app } sdcard_posix:file rw_file_perms;
 allow { appdomain -isolated_app -ephemeral_app } vfat:dir r_dir_perms;
 allow { appdomain -isolated_app -ephemeral_app } vfat:file rw_file_perms;
+allow { appdomain -isolated_app -ephemeral_app } sdcard_posix:dir r_dir_perms;
+allow { appdomain -isolated_app -ephemeral_app } sdcard_posix:file rw_file_perms;
 
 # Allow apps to use the USB Accessory interface.
 # http://developer.android.com/guide/topics/connectivity/usb/accessory.html
diff --git a/private/app_neverallows.te b/private/app_neverallows.te
index 2a75b6c8..583782d8 100644
--- a/private/app_neverallows.te
+++ b/private/app_neverallows.te
@@ -82,10 +82,7 @@ neverallow { all_untrusted_apps -mediaprovider } { cache_file cache_recovery_fil
 # application un-installation.
 neverallow { all_untrusted_apps -mediaprovider } {
   fs_type
-  -exfat                    # sdcard
   -fuse                     # sdcard
-  -fuseblk                  # sdcard
-  -ntfs                     # sdcard
   -sdcardfs                 # sdcard
   -sdcard_posix             # sdcard
   -vfat                     # sdcard
-- 
2.13.1

