From e3049a63f739c11c8074dcc4b7b9ca0272da808f Mon Sep 17 00:00:00 2001
From: LuK1337 <priv.luk@gmail.com>
Date: Wed, 21 Feb 2018 03:25:51 +0100
Subject: [PATCH 05/11] Revert "sepolicy: New type sdcard_posix for labeled
 filesystems"

This reverts commit 86e1fe9064e6930cd6816c0f381db55469785104.

Change-Id: Iee3f19e4ffdb467c47aba4c556918c97b510ecea
---
 public/domain.te | 2 +-
 public/file.te   | 1 -
 public/vold.te   | 1 -
 3 files changed, 1 insertion(+), 3 deletions(-)

diff --git a/public/domain.te b/public/domain.te
index 858e7c65..17590a3c 100644
--- a/public/domain.te
+++ b/public/domain.te
@@ -416,7 +416,7 @@ neverallow * rootfs:file { create write setattr relabelto append unlink link ren
 
 # Restrict context mounts to specific types marked with
 # the contextmount_type attribute.
-neverallow * {fs_type -contextmount_type -sdcard_posix}:filesystem relabelto;
+neverallow * {fs_type -contextmount_type}:filesystem relabelto;
 
 # Ensure that context mount types are not writable, to ensure that
 # the write to /system restriction above is not bypassed via context=
diff --git a/public/file.te b/public/file.te
index 1df9f708..bcdc4612 100644
--- a/public/file.te
+++ b/public/file.te
@@ -64,7 +64,6 @@ type shm, fs_type;
 type mqueue, fs_type;
 type fuse, sdcard_type, fs_type, mlstrustedobject;
 type sdcardfs, sdcard_type, fs_type, mlstrustedobject;
-type sdcard_posix, sdcard_type, fs_type, mlstrustedobject;
 type vfat, sdcard_type, fs_type, mlstrustedobject;
 type debugfs, fs_type, debugfs_type;
 type debugfs_mmc, fs_type, debugfs_type;
diff --git a/public/vold.te b/public/vold.te
index ffa98d70..463a0782 100644
--- a/public/vold.te
+++ b/public/vold.te
@@ -41,7 +41,6 @@ allow vold devpts:chr_file rw_file_perms;
 allow vold rootfs:dir mounton;
 allow vold sdcard_type:dir mounton; # TODO: deprecated in M
 allow vold sdcard_type:filesystem { mount remount unmount }; # TODO: deprecated in M
-allow vold sdcard_posix:filesystem { relabelto relabelfrom };
 allow vold labeledfs:filesystem { relabelfrom };
 allow vold sdcard_type:dir create_dir_perms; # TODO: deprecated in M
 allow vold sdcard_type:file create_file_perms; # TODO: deprecated in M
-- 
2.13.1

